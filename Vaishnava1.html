<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Family Registration Form</title>
  <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.5/dist/JsBarcode.all.min.js"></script>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-image: url('https://i.pinimg.com/736x/cb/cd/b7/cbcdb7948058162513a9852c4f96bfab.jpg');
      background-size: cover;
      background-repeat: no-repeat;
      background-attachment: fixed;
      padding: 20px;
      color: #333;
    }
    .container {
      background-color: rgba(255, 255, 255, 0.9);
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
      padding: 30px;
      border-radius: 10px;
      max-width: 1000px;
      margin: auto;
    }
    h2 {
      text-align: center;
    }
    label {
      font-weight: bold;
      margin-top: 10px;
      display: block;
    }
    input, select {
      width: 100%;
      padding: 8px;
      margin: 5px 0 15px 0;
      box-sizing: border-box;
    }
    .child-block {
      border: 1px solid #ccc;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
      background-color: #f9f9f9;
    }
    .barcode-container svg {
      width: 100%;
      max-width: 300px;
      margin-top: 10px;
    }
    button {
      padding: 10px 20px;
      font-size: 16px;
      margin-top: 10px;
      cursor: pointer;
    }
    .success {
      color: green;
    }
    .error {
      color: red;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>Primary Head Details / ‡∞ï‡±Å‡∞ü‡±Å‡∞Ç‡∞¨ ‡∞™‡±ç‡∞∞‡∞ß‡∞æ‡∞® ‡∞µ‡±ç‡∞Ø‡∞ï‡±ç‡∞§‡∞ø ‡∞µ‡∞ø‡∞µ‡∞∞‡∞æ‡∞≤‡±Å</h2>
    <form id="familyForm" onsubmit="saveForm(event)">
      <label>First Name / ‡∞Æ‡±ä‡∞¶‡∞ü‡∞ø ‡∞™‡±á‡∞∞‡±Å</label>
      <input type="text" name="pFirstName" required />
      
      <label>Last Name / ‡∞ö‡∞ø‡∞µ‡∞∞‡∞ø ‡∞™‡±á‡∞∞‡±Å</label>
      <input type="text" name="pLastName" required />
      
      <label>Age / ‡∞µ‡∞Ø‡∞∏‡±ç‡∞∏‡±Å</label>
      <input type="number" name="pAge" required />

      <label>Aadhar Number / ‡∞Ü‡∞ß‡∞æ‡∞∞‡±ç ‡∞®‡∞Ç‡∞¨‡∞∞‡±ç</label>
      <input type="number" name="pAadhar" pattern="\d{12}" required />
      
      <label>Phone Number / ‡∞´‡±ã‡∞®‡±ç ‡∞®‡∞Ç‡∞¨‡∞∞‡±ç</label>
      <input type="number" name="pPhone" pattern="\d{10}" required />
      
      <label>Date of Birth / ‡∞™‡±Å‡∞ü‡±ç‡∞ü‡∞ø‡∞® ‡∞§‡±á‡∞¶‡∞ø</label>
      <input type="date" name="pDob" required />

      <label>Occupation / ‡∞µ‡±É‡∞§‡±ç‡∞§‡∞ø</label>
      <input type="text" name="pOccupation" required />

      <label>Blood Group / ‡∞∞‡∞ï‡±ç‡∞§ ‡∞ó‡±ç‡∞∞‡±Ç‡∞™‡±ç</label>
      <select name="pBloodGroup" required>
        <option value="">Select / ‡∞é‡∞Ç‡∞ö‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø</option>
        <option>A+</option>
        <option>A-</option>
        <option>B+</option>
        <option>B-</option>
        <option>AB+</option>
        <option>AB-</option>
        <option>O+</option>
        <option>O-</option>
      </select>

      <label>Address / ‡∞ö‡∞ø‡∞∞‡±Å‡∞®‡∞æ‡∞Æ‡∞æ</label>
      <input type="text" name="pAddress" required />

      <label>Marital Status / ‡∞µ‡∞ø‡∞µ‡∞æ‡∞π ‡∞∏‡±ç‡∞•‡∞ø‡∞§‡∞ø</label>
      <select name="pMarital" required>
        <option value="">Select / ‡∞é‡∞Ç‡∞ö‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø</option>
        <option>Single / ‡∞í‡∞Ç‡∞ü‡∞∞‡∞ø</option>
        <option>Married / ‡∞µ‡∞ø‡∞µ‡∞æ‡∞π‡∞ø‡∞§‡±Å‡∞≤‡±Å</option>
        <option>Divorced / ‡∞µ‡∞ø‡∞°‡∞æ‡∞ï‡±Å‡∞≤‡±Å ‡∞™‡±ä‡∞Ç‡∞¶‡∞ø‡∞®</option>
        <option>Widowed / ‡∞µ‡∞ø‡∞ß‡∞µ‡±Å‡∞≤‡±Å</option>
      </select>

      <div class="barcode-container" id="primaryBarcode"></div>

      <h3><input type="checkbox" id="addChild" onclick="toggleChildren()" /> Add Child Details / ‡∞™‡∞ø‡∞≤‡±ç‡∞≤‡∞≤ ‡∞µ‡∞ø‡∞µ‡∞∞‡∞æ‡∞≤‡±Å ‡∞ú‡±ã‡∞°‡∞ø‡∞Ç‡∞ö‡∞Ç‡∞°‡∞ø</h3>

      <div id="childrenSection" style="display:none;"></div>
      <button type="button" onclick="addChild()">‚ûï Add Another Child / ‡∞Æ‡∞∞‡±ä‡∞ï ‡∞™‡∞ø‡∞≤‡±ç‡∞≤‡∞®‡±Å ‡∞ú‡±ã‡∞°‡∞ø‡∞Ç‡∞ö‡∞Ç‡∞°‡∞ø</button>

      <br><br>
      <button type="submit">üíæ Save Details / ‡∞µ‡∞ø‡∞µ‡∞∞‡∞æ‡∞≤‡∞®‡±Å ‡∞≠‡∞¶‡±ç‡∞∞‡∞™‡∞∞‡∞ö‡∞Ç‡∞°‡∞ø</button>
    </form>

    <div id="statusMessage"></div>
  </div>

  <script>
    document.querySelector('[name="pDob"]').max = new Date().toISOString().split("T")[0];

    function toggleChildren() {
      const section = document.getElementById("childrenSection");
      section.style.display = document.getElementById("addChild").checked ? "block" : "none";
      if (section.children.length === 0) addChild(); // add first block
    }

    function addChild() {
      const section = document.getElementById("childrenSection");
      const index = section.children.length;
      const div = document.createElement("div");
      div.className = "child-block";
      div.innerHTML = `
        <h3>Child ${index + 1} / ‡∞™‡∞ø‡∞≤‡±ç‡∞≤ ${index + 1}</h3>
        <label>First Name / ‡∞Æ‡±ä‡∞¶‡∞ü‡∞ø ‡∞™‡±á‡∞∞‡±Å</label>
        <input type="text" name="cFirstName" required />

        <label>Last Name / ‡∞ö‡∞ø‡∞µ‡∞∞‡∞ø ‡∞™‡±á‡∞∞‡±Å</label>
        <input type="text" name="cLastName" required />

        <label>Age / ‡∞µ‡∞Ø‡∞∏‡±ç‡∞∏‡±Å</label>
        <input type="number" name="cAge" required />

        <label>Aadhar Number / ‡∞Ü‡∞ß‡∞æ‡∞∞‡±ç ‡∞®‡∞Ç‡∞¨‡∞∞‡±ç</label>
        <input type="number" name="cAadhar" pattern="\\d{12}" required />

        <label>Phone Number / ‡∞´‡±ã‡∞®‡±ç ‡∞®‡∞Ç‡∞¨‡∞∞‡±ç</label>
        <input type="number" name="cPhone" pattern="\\d{10}" required />

        <label>Date of Birth / ‡∞™‡±Å‡∞ü‡±ç‡∞ü‡∞ø‡∞® ‡∞§‡±á‡∞¶‡∞ø</label>
        <input type="date" name="cDob" required max="${new Date().toISOString().split("T")[0]}" />

        <label>Occupation / ‡∞µ‡±É‡∞§‡±ç‡∞§‡∞ø</label>
        <input type="text" name="cOccupation" required />

        <label>Blood Group / ‡∞∞‡∞ï‡±ç‡∞§ ‡∞ó‡±ç‡∞∞‡±Ç‡∞™‡±ç</label>
        <select name="cBloodGroup" required>
          <option value="">Select / ‡∞é‡∞Ç‡∞ö‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø</option>
          <option>A+</option>
          <option>A-</option>
          <option>B+</option>
          <option>B-</option>
          <option>AB+</option>
          <option>AB-</option>
          <option>O+</option>
          <option>O-</option>
        </select>

        <label>Address / ‡∞ö‡∞ø‡∞∞‡±Å‡∞®‡∞æ‡∞Æ‡∞æ</label>
        <input type="text" name="cAddress" required />

        <label>Marital Status / ‡∞µ‡∞ø‡∞µ‡∞æ‡∞π ‡∞∏‡±ç‡∞•‡∞ø‡∞§‡∞ø</label>
        <select name="cMarital" required>
          <option value="">Select / ‡∞é‡∞Ç‡∞ö‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø</option>
          <option>Single / ‡∞í‡∞Ç‡∞ü‡∞∞‡∞ø</option>
          <option>Married / ‡∞µ‡∞ø‡∞µ‡∞æ‡∞π‡∞ø‡∞§‡±Å‡∞≤‡±Å</option>
          <option>Divorced / ‡∞µ‡∞ø‡∞°‡∞æ‡∞ï‡±Å‡∞≤‡±Å ‡∞™‡±ä‡∞Ç‡∞¶‡∞ø‡∞®</option>
          <option>Widowed / ‡∞µ‡∞ø‡∞ß‡∞µ‡±Å‡∞≤‡±Å</option>
        </select>

        <label>Relation / ‡∞∏‡∞Ç‡∞¨‡∞Ç‡∞ß‡∞Ç</label>
        <select name="cRelation" required>
          <option value="">Select / ‡∞é‡∞Ç‡∞ö‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø</option>
          <option>Son / ‡∞ï‡±Å‡∞Æ‡∞æ‡∞∞‡±Å‡∞°‡±Å</option>
          <option>Daughter / ‡∞ï‡±Å‡∞Æ‡∞æ‡∞∞‡±ç‡∞§‡±Ü</option>
          <option>Nephew / ‡∞Æ‡±á‡∞®‡∞Æ‡∞æ‡∞Æ</option>
          <option>Niece / ‡∞Æ‡±á‡∞®‡∞ï‡±ã‡∞°‡∞≤‡±Å</option>
          <option>Grandchild / ‡∞Æ‡∞®‡∞µ‡∞°‡±Å</option>
        </select>

        <div class="barcode-container" id="childBarcode${index}"></div>
      `;
      section.appendChild(div);
    }

    function showStatus(msg, success = true) {
      const status = document.getElementById("statusMessage");
      status.textContent = msg;
      status.className = success ? "success" : "error";
    }

    function generateBarcode(id, containerId) {
      const svg = document.createElement("svg");
      JsBarcode(svg, id, { format: "CODE128", displayValue: true });
      const target = document.getElementById(containerId);
      target.innerHTML = "";
      target.appendChild(svg);
    }

    function saveForm(e) {
      e.preventDefault();
      const form = document.getElementById("familyForm");

      const get = name => form.querySelector(`[name="${name}"]`)?.value.trim() || "";

      const primaryId = "P" + Date.now();
      generateBarcode(primaryId, "primaryBarcode");

      const primary = {
        id: primaryId,
        firstName: get("pFirstName"),
        lastName: get("pLastName"),
        age: get("pAge"),
        aadhar: get("pAadhar"),
        phone: get("pPhone"),
        dob: get("pDob"),
        occupation: get("pOccupation"),
        bloodGroup: get("pBloodGroup"),
        address: get("pAddress"),
        marital: get("pMarital")
      };

      const children = [];
      if (document.getElementById("addChild").checked) {
        const blocks = document.querySelectorAll(".child-block");
        for (let i = 0; i < blocks.length; i++) {
          const b = blocks[i];
          const getField = n => b.querySelector(`[name="${n}"]`)?.value.trim() || "";
          const childId = "C" + Date.now() + "_" + i;
          generateBarcode(childId, "childBarcode" + i);
          children.push({
            id: childId,
            firstName: getField("cFirstName"),
            lastName: getField("cLastName"),
            age: getField("cAge"),
            aadhar: getField("cAadhar"),
            phone: getField("cPhone"),
            dob: getField("cDob"),
            occupation: getField("cOccupation"),
            bloodGroup: getField("cBloodGroup"),
            address: getField("cAddress"),
            marital: getField("cMarital"),
            relation: getField("cRelation")
          });
        }
      }

      const saved = JSON.parse(localStorage.getItem("families") || "[]");
      saved.push({ primary, children });
      localStorage.setItem("families", JSON.stringify(saved));

      showStatus("‚úÖ Saved Successfully / ‡∞µ‡∞ø‡∞ú‡∞Ø‡∞µ‡∞Ç‡∞§‡∞Ç‡∞ó‡∞æ ‡∞≠‡∞¶‡±ç‡∞∞‡∞™‡∞∞‡∞ö‡∞¨‡∞°‡∞ø‡∞Ç‡∞¶‡∞ø!");
      form.reset();
      document.getElementById("childrenSection").innerHTML = "";
      toggleChildren();
    }
  </script>
</body>
</html>
